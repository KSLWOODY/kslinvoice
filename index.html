<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ì†¡ì¥ë²ˆí˜¸ ì¡°íšŒ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; font-size: 18px; max-width: 600px; margin: auto; }
    h2 { font-size: 24px; text-align: center; }
    select, input[type="text"], button {
      width: 100%; padding: 12px; margin-top: 10px; font-size: 18px; box-sizing: border-box;
    }
    button { background-color: #007BFF; color: white; border: none; border-radius: 5px; }
    button:hover { background-color: #0056b3; }
    #result { margin-top: 20px; font-size: 20px; font-weight: bold; text-align: center; }
  </style>
</head>
<body>

  <h2>ì†¡ì¥ë²ˆí˜¸ ì¡°íšŒ</h2>

  <label for="fileSelector">ì£¼ë¬¸ì¼ ì„ íƒ</label>
  <select id="fileSelector">
    <option value="0901.xlsx">9ì›” 01ì¼</option>
    <option value="0908.xlsx">9ì›” 08ì¼</option>
  </select>

  <input type="text" id="searchInput" placeholder="MIS" />
  <button id="searchBtn">ê²€ìƒ‰</button>

  <p id="result">íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>

  <script>
    const fileSelector = document.getElementById('fileSelector');
    let dataMap = {
      "0901.xlsx": [],
      "0908.xlsx": []
    };

    // ì—‘ì…€ íŒŒì¼ì„ ë¯¸ë¦¬ ëª¨ë‘ ë¶ˆëŸ¬ì˜¤ê¸°
    const loadExcel = (filename) => {
      return fetch(filename)
        .then(response => response.arrayBuffer())
        .then(data => {
          const workbook = XLSX.read(data, { type: 'array' });
          const sheet = workbook.Sheets[workbook.SheetNames[0]];
          const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
          dataMap[filename] = jsonData.slice(1); // í—¤ë” ì œì™¸
        });
    };

    Promise.all([loadExcel("0901.xlsx"), loadExcel("0908.xlsx")])
      .then(() => {
        document.getElementById("result").textContent = "MISë¡œ ì¡°íšŒ";
      })
      .catch(() => {
        document.getElementById("result").textContent = "íŒŒì¼ ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨.";
      });

    document.getElementById('searchBtn').addEventListener('click', () => {
      const selectedFile = fileSelector.value;
      const input = document.getElementById('searchInput').value.trim();
      const resultEl = document.getElementById('result');
      const data = dataMap[selectedFile];

      const found = data.find(row => row[0]?.toString().trim() === input);

      if (found) {
        resultEl.textContent = `ê²°ê³¼: ${found[1] ?? "ì—†ìŒ"}`;
      } else {
        resultEl.textContent = "ì¼ì¹˜í•˜ëŠ” í•­ëª©ì´ ì—†ìŠµë‹ˆë‹¤.";
      }
    });
  </script>
<div style="text-align:center; margin-top:30px;">
  <a href="https://www.cjlogistics.com/ko/tool/parcel/tracking" target="_blank">
    <button style="padding:12px 20px; font-size:18px; background-color:#28a745; color:white; border:none; border-radius:5px;">
      ğŸ“¦ CJëŒ€í•œí†µìš´ ë°°ì†¡ì¡°íšŒ
    </button>
  </a>
</div>

</body>
</html>









