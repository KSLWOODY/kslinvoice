<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>송장번호 조회</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; font-size: 18px; max-width: 600px; margin: auto; }
    h2 { font-size: 24px; text-align: center; }
    select, input[type="text"], button {
      width: 100%; padding: 12px; margin-top: 10px; font-size: 18px; box-sizing: border-box;
    }
    button { background-color: #007BFF; color: white; border: none; border-radius: 5px; }
    button:hover { background-color: #0056b3; }
    #result { margin-top: 20px; font-size: 20px; font-weight: bold; text-align: center; }
  </style>
</head>
<body>

  <h2>송장번호 조회</h2>

  <label for="fileSelector">주문일 선택</label>
  <select id="fileSelector">
    <option value="0721.xlsx">7월 21일</option>
    <option value="0728.xlsx">7월 28일</option>
  </select>

  <input type="text" id="searchInput" placeholder="MIS" />
  <button id="searchBtn">검색</button>

  <p id="result">파일을 불러오는 중...</p>

  <script>
    const fileSelector = document.getElementById('fileSelector');
    let dataMap = {
      "0721.xlsx": [],
      "0728.xlsx": []
    };

    // 엑셀 파일을 미리 모두 불러오기
    const loadExcel = (filename) => {
      return fetch(filename)
        .then(response => response.arrayBuffer())
        .then(data => {
          const workbook = XLSX.read(data, { type: 'array' });
          const sheet = workbook.Sheets[workbook.SheetNames[0]];
          const jsonData = XLSX.utils.sheet_to_json(sheet, { header: 1 });
          dataMap[filename] = jsonData.slice(1); // 헤더 제외
        });
    };

    Promise.all([loadExcel("0721.xlsx"), loadExcel("0728.xlsx")])
      .then(() => {
        document.getElementById("result").textContent = "검색할 수 있습니다.";
      })
      .catch(() => {
        document.getElementById("result").textContent = "파일 불러오기 실패.";
      });

    document.getElementById('searchBtn').addEventListener('click', () => {
      const selectedFile = fileSelector.value;
      const input = document.getElementById('searchInput').value.trim();
      const resultEl = document.getElementById('result');
      const data = dataMap[selectedFile];

      const found = data.find(row => row[0]?.toString().trim() === input);

      if (found) {
        resultEl.textContent = `결과: ${found[1] ?? "없음"}`;
      } else {
        resultEl.textContent = "일치하는 항목이 없습니다.";
      }
    });
  </script>

</body>
</html>



